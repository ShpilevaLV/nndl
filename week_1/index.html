<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Titanic EDA - Find the Key Factor</title>
    <script src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f8f9fa; padding-top: 20px; }
        .card { margin-bottom: 20px; border: none; box-shadow: 0 2px 4px rgba(0,0,0,.05); }
        .card-header { font-weight: bold; }
        .prompt-section { background-color: #e8f4fd; border-left: 4px solid #0d6efd; }
        #dataTable { font-size: 0.85em; }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="text-center mb-4">üö¢ Titanic EDA: Find the Main Factor</h1>
        <p class="lead text-center">This dashboard helps you perform your <strong>own</strong> Exploratory Data Analysis (EDA). Form your hypothesis, explore the data, and prove your conclusion.</p>

        <!-- Section 1: YOUR PROMPT & HYPOTHESIS -->
        <div class="row prompt-section p-4 mb-4 rounded">
            <div class="col-12">
                <h4>üìù Your EDA Prompt & Hypothesis</h4>
                <p><em>The assignment: <strong>"Try to Perform EDA with your own prompt. Figure out the most important factor of die in Titanic based on EDA"</strong></em></p>
                <div class="mb-3">
                    <label for="hypothesisInput" class="form-label"><strong>Your Hypothesis:</strong> What do you think is the main factor for not surviving (dying)?</label>
                    <textarea class="form-control" id="hypothesisInput" rows="2" placeholder="E.g., I think 'Gender' is the main factor because of the 'women and children first' protocol. Or, I believe 'Passenger Class' was decisive because of the location of cabins..."></textarea>
                </div>
                <button class="btn btn-primary" onclick="updateFindings()">Update My Conclusion</button>
            </div>
        </div>

        <!-- Section 2: DATA LOADING & OVERVIEW -->
        <div class="row">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header bg-primary text-white">1. Load & Inspect Data</div>
                    <div class="card-body">
                        <p>Load the Titanic dataset to start your analysis.</p>
                        <button class="btn btn-success mb-3" onclick="loadData()">Load Training Data (train.csv)</button>
                        <div id="dataStatus"></div>
                        <div class="mb-3">
                            <label class="form-label"><strong>Preview first 10 rows:</strong></label>
                            <div id="dataPreview" class="table-responsive"></div>
                        </div>
                        <div id="basicStats"></div>
                    </div>
                </div>
            </div>

            <!-- Section 3: DATA FILTERING (YOUR EDA TOOL) -->
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header bg-info text-white">2. Filter & Explore (Your EDA Tool)</div>
                    <div class="card-body">
                        <p>Filter the data to test your hypothesis. For example, compare survival rates for different groups.</p>
                        <div class="row g-3">
                            <div class="col-md-6">
                                <label class="form-label">Filter by Sex</label>
                                <select id="filterSex" class="form-select" onchange="applyFilters()">
                                    <option value="all">All</option>
                                    <option value="male">Male</option>
                                    <option value="female">Female</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Filter by Passenger Class</label>
                                <select id="filterPclass" class="form-select" onchange="applyFilters()">
                                    <option value="all">All</option>
                                    <option value="1">1st Class</option>
                                    <option value="2">2nd Class</option>
                                    <option value="3">3rd Class</option>
                                </select>
                            </div>
                        </div>
                        <p class="mt-3"><strong>Survival rate in filtered group:</strong></p>
                        <h3 id="survivalRateText" class="text-center">--%</h3>
                        <div id="filteredStats"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Section 4: VISUAL ANALYSIS (YOUR CHARTS) -->
        <div class="row mt-4">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-header bg-warning text-dark">3. Visual Analysis - Build Your Argument</div>
                    <div class="card-body">
                        <p>Create charts to support or refute your hypothesis. Look for the biggest differences.</p>
                        <div class="row">
                            <div class="col-lg-6">
                                <div id="chart1" style="height: 400px;"></div>
                                <p class="text-center"><small><strong>Chart 1:</strong> Survival by Gender</small></p>
                            </div>
                            <div class="col-lg-6">
                                <div id="chart2" style="height: 400px;"></div>
                                <p class="text-center"><small><strong>Chart 2:</strong> Survival by Passenger Class</small></p>
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col-lg-6">
                                <div id="chart3" style="height: 400px;"></div>
                                <p class="text-center"><small><strong>Chart 3:</strong> Survival by Age Group</small></p>
                            </div>
                            <div class="col-lg-6">
                                <div id="chart4" style="height: 400px;"></div>
                                <p class="text-center"><small><strong>Chart 4:</strong> Survival by Embarkation Port</small></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Section 5: YOUR CONCLUSION -->
        <div class="row mt-4">
            <div class="col-12">
                <div class="card border-success">
                    <div class="card-header bg-success text-white">4. Your EDA Conclusion: The Main Factor of Dying</div>
                    <div class="card-body">
                        <div id="conclusionPlaceholder">
                            <p><em>Your reasoned conclusion will appear here after you interact with the data and click "Update My Conclusion".</em></p>
                        </div>
                        <div id="userConclusion" style="display: none;">
                            <h5>My Hypothesis:</h5>
                            <p id="conclusionHypothesis"></p>
                            <h5>Key Evidence from My EDA:</h5>
                            <ul id="conclusionEvidence"></ul>
                            <h5>My Verdict on the Most Important Factor:</h5>
                            <div class="alert alert-dark" role="alert">
                                <h4 id="conclusionVerdict" class="mb-0"></h4>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <footer class="mt-5 text-center text-muted">
            <p>Titanic EDA Dashboard | Deploy on GitHub Pages by committing this <code>index.html</code>, <code>app.js</code>, and <code>data/train.csv</code> to your repository.</p>
        </footer>
    </div>

    <!-- SCRIPTS -->
    <script src="app.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
